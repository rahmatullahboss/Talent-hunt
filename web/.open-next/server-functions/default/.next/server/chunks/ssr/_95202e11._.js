module.exports=[94531,a=>{"use strict";var b=a.i(37936),c=a.i(18558),d=a.i(53112),e=a.i(58840),f=a.i(22028),g=a.i(13095);let h=d.z.object({userId:d.z.string(),suspend:d.z.coerce.boolean()}),i=d.z.object({commission:d.z.coerce.number().min(0).max(100),bankAccountName:d.z.string().optional(),bankAccountNumber:d.z.string().optional(),bankName:d.z.string().optional(),walletProvider:d.z.string().optional(),walletNumber:d.z.string().optional()}),j=d.z.object({disputeId:d.z.string(),status:d.z.enum(["open","under_review","resolved","closed"]),resolution:d.z.string().optional()}),k=d.z.object({jobId:d.z.string()});async function l(){let a=await (0,e.getCurrentUser)();if(!a?.profile||"admin"!==a.profile.role)throw Error("Admin access required");let b=(0,e.getDB)();if(!b)throw Error("Database not available");return{auth:a,db:b}}async function m(a,b){try{let{auth:a,db:d}=await l(),e=h.parse({userId:b.get("userId"),suspend:"true"===b.get("suspend")});if(e.userId===a.profile?.id)return{status:"error",message:"You cannot suspend your own admin account."};return await d.prepare("UPDATE profiles SET is_suspended = ?, updated_at = datetime('now') WHERE id = ?").bind(+!!e.suspend,e.userId).run(),(0,c.revalidatePath)("/admin/users"),{status:"success",message:e.suspend?"User suspended.":"User reinstated."}}catch(a){return{status:"error",message:a instanceof Error?a.message:"Failed to update user"}}}async function n(a,b){try{let{db:a}=await l(),d=i.parse({commission:b.get("commission"),bankAccountName:b.get("bankAccountName"),bankAccountNumber:b.get("bankAccountNumber"),bankName:b.get("bankName"),walletProvider:b.get("walletProvider"),walletNumber:b.get("walletNumber")});if(await a.prepare("SELECT id FROM admin_settings LIMIT 1").first())await a.prepare(`UPDATE admin_settings SET 
           commission_percentage = ?, bank_account_name = ?, bank_account_number = ?, bank_name = ?, 
           mobile_wallet_provider = ?, mobile_wallet_number = ?, updated_at = datetime('now')`).bind(d.commission,d.bankAccountName??null,d.bankAccountNumber??null,d.bankName??null,d.walletProvider??null,d.walletNumber??null).run();else{let b=(0,f.generateId)();await a.prepare(`INSERT INTO admin_settings (id, commission_percentage, bank_account_name, bank_account_number, bank_name, mobile_wallet_provider, mobile_wallet_number)
           VALUES (?, ?, ?, ?, ?, ?, ?)`).bind(b,d.commission,d.bankAccountName??null,d.bankAccountNumber??null,d.bankName??null,d.walletProvider??null,d.walletNumber??null).run()}return(0,c.revalidatePath)("/admin/settings"),(0,c.revalidatePath)("/employer/payments"),(0,c.revalidatePath)("/freelancer/wallet"),{status:"success",message:"Settings updated."}}catch(a){return{status:"error",message:a instanceof Error?a.message:"Failed to update settings"}}}async function o(a,b){try{let{db:a}=await l(),d=j.parse({disputeId:b.get("disputeId"),status:b.get("status"),resolution:b.get("resolution")});return await a.prepare("UPDATE disputes SET status = ?, resolution = ?, updated_at = datetime('now') WHERE id = ?").bind(d.status,d.resolution??null,d.disputeId).run(),(0,c.revalidatePath)("/admin/disputes"),(0,c.revalidatePath)(`/contracts/${d.disputeId}`),{status:"success",message:"Dispute updated."}}catch(a){return{status:"error",message:a instanceof Error?a.message:"Failed to update dispute"}}}async function p(a,b){try{let{db:a}=await l(),d=k.parse({jobId:b.get("jobId")});return await a.prepare("UPDATE jobs SET status = 'cancelled', updated_at = datetime('now') WHERE id = ?").bind(d.jobId).run(),(0,c.revalidatePath)("/admin/jobs"),(0,c.revalidatePath)(`/employer/jobs/${d.jobId}`),(0,c.revalidatePath)("/freelancer/jobs"),{status:"success",message:"Job cancelled."}}catch(a){return{status:"error",message:a instanceof Error?a.message:"Failed to cancel job"}}}(0,g.ensureServerEntryExports)([m,n,o,p]),(0,b.registerServerReference)(m,"60757279e812e67028ecbeef1c6e64e691475fe482",null),(0,b.registerServerReference)(n,"60105859c130e9136b231424f8c3858d6db02e54b1",null),(0,b.registerServerReference)(o,"60cd0d5adff6d03621697ca46a0180f6bb5d1ed316",null),(0,b.registerServerReference)(p,"604c6dcff0c9639d2c83d430cf455fecd7de8dbc4c",null),a.s(["cancelJobAction",()=>p,"toggleUserSuspensionAction",()=>m,"updateAdminSettingsAction",()=>n,"updateDisputeAction",()=>o])},85059,a=>{"use strict";var b=a.i(94531);a.s([],68953),a.i(68953),a.s(["604c6dcff0c9639d2c83d430cf455fecd7de8dbc4c",()=>b.cancelJobAction],85059)}];

//# sourceMappingURL=_95202e11._.js.map