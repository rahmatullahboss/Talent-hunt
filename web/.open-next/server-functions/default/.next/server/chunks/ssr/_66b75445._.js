module.exports=[88347,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={ACTION_HMR_REFRESH:function(){return k},ACTION_NAVIGATE:function(){return h},ACTION_REFRESH:function(){return g},ACTION_RESTORE:function(){return i},ACTION_SERVER_ACTION:function(){return l},ACTION_SERVER_PATCH:function(){return j},PrefetchKind:function(){return m}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g="refresh",h="navigate",i="restore",j="server-patch",k="hmr-refresh",l="server-action";var m=((d={}).AUTO="auto",d.FULL="full",d.TEMPORARY="temporary",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},67009,(a,b,c)=>{"use strict";function d(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isThenable",{enumerable:!0,get:function(){return d}})},90841,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={dispatchAppRouterAction:function(){return i},useActionQueue:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(46058)._(a.r(72131)),g=a.r(67009),h=null;function i(a){if(null===h)throw Object.defineProperty(Error("Internal Next.js error: Router action dispatched before initialization."),"__NEXT_ERROR_CODE",{value:"E668",enumerable:!1,configurable:!0});h(a)}function j(a){let[b,c]=f.default.useState(a.state);h=b=>a.dispatch(b,c);let d=(0,f.useMemo)(()=>b,[b]);return(0,g.isThenable)(d)?(0,f.use)(d):d}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},20611,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"callServer",{enumerable:!0,get:function(){return g}});let d=a.r(72131),e=a.r(88347),f=a.r(90841);async function g(a,b){return new Promise((c,g)=>{(0,d.startTransition)(()=>{(0,f.dispatchAppRouterAction)({type:e.ACTION_SERVER_ACTION,actionId:a,actionArgs:b,resolve:c,reject:g})})})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},1722,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"findSourceMapURL",{enumerable:!0,get:function(){return d}});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},99570,a=>{"use strict";let b,c,d;var e=a.i(87924),f=a.i(72131);function g(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}var h=Symbol.for("react.lazy"),i=f[" use ".trim().toString()];function j(a){var b;return null!=a&&"object"==typeof a&&"$$typeof"in a&&a.$$typeof===h&&"_payload"in a&&"object"==typeof(b=a._payload)&&null!==b&&"then"in b}var k=((d=f.forwardRef((a,b)=>{let{children:c,...d}=a;if(j(c)&&"function"==typeof i&&(c=i(c._payload)),f.isValidElement(c)){var e;let a,h,i=(e=c,(h=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(h=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),j=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==f.Fragment&&(j.ref=b?function(...a){return b=>{let c=!1,d=a.map(a=>{let d=g(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():g(a[b],null)}}}}(b,i):i),f.cloneElement(c,j)}return f.Children.count(c)>1?f.Children.only(null):null})).displayName="Slot.SlotClone",b=d,(c=f.forwardRef((a,c)=>{let{children:d,...g}=a;j(d)&&"function"==typeof i&&(d=i(d._payload));let h=f.Children.toArray(d),k=h.find(m);if(k){let a=k.props.children,d=h.map(b=>b!==k?b:f.Children.count(a)>1?f.Children.only(null):f.isValidElement(a)?a.props.children:null);return(0,e.jsx)(b,{...g,ref:c,children:f.isValidElement(a)?f.cloneElement(a,void 0,d):null})}return(0,e.jsx)(b,{...g,ref:c,children:d})})).displayName="Slot.Slot",c),l=Symbol("radix.slottable");function m(a){return f.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===l}var n=a.i(68114);let o={default:"bg-accent text-white hover:bg-[#108a00] hover:text-white",secondary:"border border-accent bg-white text-accent hover:bg-[#e9f7e9]",outline:"border border-card-border bg-card text-foreground hover:border-accent hover:text-accent",ghost:"text-foreground hover:bg-[#e9f7e9]",destructive:"bg-red-500 text-white hover:bg-red-600",link:"bg-transparent text-accent underline-offset-4 hover:underline"},p={sm:"h-9 px-3 text-xs",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",icon:"h-10 w-10"},q=(0,f.forwardRef)(({asChild:a,className:b,variant:c="default",size:d="md",loading:f,children:g,disabled:h,...i},j)=>{let l=a?k:"button",m=(0,n.cn)("inline-flex items-center justify-center gap-2 rounded-[var(--radius-md)] font-medium transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:pointer-events-none disabled:opacity-60",o[c],p[d],b);return a?(0,e.jsx)(l,{ref:j,className:m,...i,children:g}):(0,e.jsxs)(l,{ref:j,className:m,disabled:h||f,...i,children:[f?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent","aria-hidden":"true"}),(0,e.jsx)("span",{className:"sr-only",children:"Loading"})]}):null,(0,e.jsx)("span",{children:g})]})});q.displayName="Button",a.s(["Button",0,q],99570)},91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=(0,c.forwardRef)(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-[var(--radius-lg)] border border-card-border bg-card p-6 shadow-sm shadow-foreground/5",a),...c}));e.displayName="Card",a.s(["Card",0,e])},86304,a=>{"use strict";var b=a.i(87924),c=a.i(68114);let d={default:"bg-foreground text-background",outline:"border border-card-border text-foreground",muted:"bg-foreground/10 text-foreground",success:"bg-emerald-500/15 text-emerald-600",danger:"bg-red-500/15 text-red-600"};function e({className:a,variant:e="default",...f}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full px-3 py-1 text-xs font-medium uppercase tracking-wide",d[e],a),...f})}a.s(["Badge",()=>e])},66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=(0,c.forwardRef)(({className:a,...c},e)=>(0,b.jsx)("input",{ref:e,className:(0,d.cn)("flex h-11 w-full rounded-[var(--radius-md)] border border-card-border bg-card px-4 text-foreground shadow-sm transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent placeholder:text-muted/60 disabled:cursor-not-allowed disabled:opacity-60",a),...c}));e.displayName="Input",a.s(["Input",0,e])},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},29246,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=(0,c.forwardRef)(({className:a,...c},e)=>(0,b.jsx)("textarea",{ref:e,className:(0,d.cn)("flex min-h-[120px] w-full rounded-[var(--radius-md)] border border-card-border bg-card px-4 py-3 text-foreground shadow-sm transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent placeholder:text-muted/60 disabled:cursor-not-allowed disabled:opacity-60",a),...c}));e.displayName="Textarea",a.s(["Textarea",0,e])},70106,a=>{"use strict";var b=a.i(72131);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],70106)},54476,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(23292),e=a.i(29246),f=a.i(99570);let g=(0,a.i(70106).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var h=a.i(98621);function i({url:a,isCurrent:c}){let{host:d,label:e,initials:f}=function(a){try{let b=new URL(a),c=b.hostname.replace(/^www\./,""),d=`${b.pathname}${b.search}${b.hash}`,e=d&&"/"!==d?decodeURI(d):void 0;return{host:c,label:e??c,initials:c.replace(/[^a-zA-Z0-9]/g,"").slice(0,2).toUpperCase()||c.slice(0,2).toUpperCase()}}catch{return{host:a.replace(/^https?:\/\//,""),label:a,initials:a.slice(0,2).toUpperCase()}}}(a);return(0,b.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:(0,h.default)("group block w-full overflow-hidden rounded-[var(--radius-md)] border text-left shadow-sm transition hover:-translate-y-[1px] hover:shadow-md",c?"border-accent-foreground/20 bg-accent/90 text-accent-foreground":"border-card-border/70 bg-card text-foreground"),children:(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3",children:[(0,b.jsx)("div",{className:(0,h.default)("flex h-10 w-10 shrink-0 items-center justify-center rounded-md text-sm font-semibold",c?"bg-accent-foreground/15 text-accent-foreground":"bg-foreground/10 text-foreground"),children:f}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"truncate text-sm font-medium",children:d}),(0,b.jsx)("p",{className:(0,h.default)("truncate text-xs",c?"text-accent-foreground/80":"text-muted-foreground"),children:e})]}),(0,b.jsx)(g,{className:(0,h.default)("h-4 w-4 shrink-0 transition group-hover:translate-x-[1px] group-hover:-translate-y-[1px]",c?"text-accent-foreground/80":"text-muted-foreground")})]})})}function j({contractId:a,currentUserId:g,participants:h,initialMessages:j}){let[k,l]=(0,c.useState)(j),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),q=(0,c.useRef)(null),r=(0,c.useCallback)(async()=>{try{let b=await fetch(`/api/contracts/${a}/messages`);if(b.ok){let a=await b.json();a.messages&&l(a.messages)}}catch{}},[a]);(0,c.useEffect)(()=>{let a=setInterval(r,5e3);return()=>clearInterval(a)},[r]),(0,c.useEffect)(()=>{q.current?.scrollIntoView({behavior:"smooth"})},[k]);let s=async()=>{if(m.trim()&&!o){p(!0);try{let b=await fetch(`/api/contracts/${a}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:m.trim()})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to send message")}n(""),await r()}catch(b){let a=b instanceof Error?b.message:"Failed to send message";d.toast.error(a)}finally{p(!1)}}};return(0,b.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 space-y-3 overflow-auto rounded-[var(--radius-md)] border border-card-border/70 bg-card/60 p-4",children:[k.map(a=>{let d=a.sender_id===g,e=h.find(b=>b.id===a.sender_id),f=a.content.split(/(https?:\/\/[^\s]+)/g),j=Array.from(new Set(f.filter(a=>a.startsWith("http://")||a.startsWith("https://"))));return(0,b.jsxs)("div",{className:`flex flex-col ${d?"items-end":"items-start"}`,children:[(0,b.jsx)("span",{className:"text-xs text-muted",children:e?.name??"Member"}),(0,b.jsx)("div",{className:`mt-1 max-w-[70%] rounded-[var(--radius-md)] px-3 py-2 text-sm ${d?"bg-accent text-accent-foreground":"bg-foreground/10 text-foreground"}`,children:(0,b.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed",children:f.map((d,e)=>d?d.startsWith("http://")||d.startsWith("https://")?(0,b.jsxs)(c.Fragment,{children:[(0,b.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"break-words font-medium underline decoration-current underline-offset-2 transition hover:opacity-80",children:d})," "]},`${a.id}-segment-${e}`):(0,b.jsx)("span",{children:d},`${a.id}-segment-${e}`):null)})}),j.length>0?(0,b.jsx)("div",{className:"mt-2 flex w-full max-w-[70%] flex-col gap-2",children:j.map(c=>(0,b.jsx)(i,{url:c,isCurrent:d},`${a.id}-${c}`))}):null,(0,b.jsx)("span",{className:"mt-1 text-[11px] text-muted",children:new Date(a.created_at).toLocaleString()})]},a.id)}),(0,b.jsx)("div",{ref:q})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Textarea,{value:m,onChange:a=>n(a.target.value),rows:3,placeholder:"Share updates, questions, or files (paste link)."}),(0,b.jsx)(f.Button,{onClick:s,loading:o,children:"Send"})]})]})}a.s(["ContractChat",()=>j],54476)},61740,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(35112),e=a.i(23292),f=a.i(5050),g=(0,f.createServerReference)("6056b793c2905a4401aa79482b322c3b7bc28acfc2",f.callServer,void 0,f.findSourceMapURL,"createMilestoneAction"),h=(0,f.createServerReference)("602eaae21159f520e50bf97595e24303dbcde59902",f.callServer,void 0,f.findSourceMapURL,"submitMilestoneAction"),i=(0,f.createServerReference)("608bb6de273b928b66ba5f7036ef8587e7ad85eebf",f.callServer,void 0,f.findSourceMapURL,"updateMilestoneStatusAction"),j=a.i(91119),k=a.i(86304),l=a.i(66718),m=a.i(29246),n=a.i(99570);let o={status:"idle"};function p({contractId:a,milestones:c,role:d}){return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:"Milestones"}),"employer"===d?(0,b.jsx)(q,{contractId:a}):null]}),(0,b.jsx)("div",{className:"grid gap-3",children:0===c.length?(0,b.jsx)(j.Card,{className:"border-dashed p-4 text-sm text-muted",children:"No milestones yet."}):c.map(c=>(0,b.jsxs)(j.Card,{className:"space-y-3 border border-card-border/70 bg-card/80 p-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-lg font-semibold text-foreground",children:c.title}),(0,b.jsxs)("p",{className:"text-sm text-muted",children:["à§³",Number(c.amount??0).toLocaleString()]}),c.due_date?(0,b.jsxs)("p",{className:"text-xs text-muted",children:["Due ",new Date(c.due_date).toLocaleDateString()]}):null]}),(0,b.jsx)(k.Badge,{variant:"muted",children:c.status})]}),c.deliverable_url?(0,b.jsx)("a",{href:c.deliverable_url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline",children:"View deliverable"}):null,c.notes?(0,b.jsxs)("p",{className:"text-sm text-muted",children:["Notes: ",c.notes]}):null,"freelancer"===d&&"pending"===c.status?(0,b.jsx)(r,{contractId:a,milestoneId:c.id}):null,"employer"===d&&"in_review"===c.status?(0,b.jsx)(s,{contractId:a,milestoneId:c.id}):null]},c.id))})]})}function q({contractId:a}){let[f,h]=(0,d.useFormState)(g,o),[i,j]=(0,c.useTransition)();return(0,c.useEffect)(()=>{"error"===f.status&&f.message?e.toast.error(f.message):"success"===f.status&&f.message&&e.toast.success(f.message)},[f]),(0,b.jsxs)("form",{className:"flex flex-wrap items-center gap-2",action:a=>{j(()=>h(a))},children:[(0,b.jsx)("input",{type:"hidden",name:"contractId",value:a}),(0,b.jsx)(l.Input,{name:"title",placeholder:"Milestone title",required:!0,className:"w-40"}),(0,b.jsx)(l.Input,{name:"amount",type:"number",min:0,step:"10",placeholder:"Amount",required:!0,className:"w-32"}),(0,b.jsx)(l.Input,{name:"dueDate",type:"date",className:"w-36"}),(0,b.jsx)(n.Button,{type:"submit",size:"sm",loading:i,children:"Add"})]})}function r({contractId:a,milestoneId:f}){let[g,i]=(0,d.useFormState)(h,o),[j,k]=(0,c.useTransition)();return(0,c.useEffect)(()=>{"error"===g.status&&g.message?e.toast.error(g.message):"success"===g.status&&g.message&&e.toast.success(g.message)},[g]),(0,b.jsxs)("form",{className:"space-y-2",action:a=>{k(()=>i(a))},children:[(0,b.jsx)("input",{type:"hidden",name:"contractId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"milestoneId",value:f}),(0,b.jsx)(l.Input,{name:"deliverableUrl",placeholder:"Deliverable URL"}),(0,b.jsx)(m.Textarea,{name:"notes",rows:2,placeholder:"Notes for the employer"}),(0,b.jsx)(n.Button,{type:"submit",size:"sm",loading:j,children:"Submit for review"})]})}function s({contractId:a,milestoneId:f}){let[g,h]=(0,d.useFormState)(i,o),[j,k]=(0,c.useTransition)();return(0,c.useEffect)(()=>{"error"===g.status&&g.message?e.toast.error(g.message):"success"===g.status&&g.message&&e.toast.success(g.message)},[g]),(0,b.jsxs)("form",{className:"flex items-center gap-2",action:a=>{k(()=>h(a))},children:[(0,b.jsx)("input",{type:"hidden",name:"contractId",value:a}),(0,b.jsx)("input",{type:"hidden",name:"milestoneId",value:f}),(0,b.jsx)(n.Button,{type:"submit",size:"sm",name:"status",value:"approved",variant:"ghost",loading:j,children:"Approve"}),(0,b.jsx)(n.Button,{type:"submit",size:"sm",name:"status",value:"rejected",variant:"ghost",loading:j,children:"Request changes"})]})}a.s(["MilestonesSection",()=>p],61740)}];

//# sourceMappingURL=_66b75445._.js.map