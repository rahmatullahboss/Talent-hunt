(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87486,e=>{"use strict";var t=e.i(43476),r=e.i(75157);let s={default:"bg-foreground text-background",outline:"border border-card-border text-foreground",muted:"bg-foreground/10 text-foreground",success:"bg-emerald-500/15 text-emerald-600",danger:"bg-red-500/15 text-red-600"};function a({className:e,variant:a="default",...n}){return(0,t.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full px-3 py-1 text-xs font-medium uppercase tracking-wide",s[a],e),...n})}e.s(["Badge",()=>a])},19455,e=>{"use strict";let t,r,s;var a=e.i(43476),n=e.i(71645);function i(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var l=Symbol.for("react.lazy"),o=n[" use ".trim().toString()];function d(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===l&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var c=((s=n.forwardRef((e,t)=>{let{children:r,...s}=e;if(d(r)&&"function"==typeof o&&(r=o(r._payload)),n.isValidElement(r)){var a;let e,l,o=(a=r,(l=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(l=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),d=function(e,t){let r={...t};for(let s in t){let a=e[s],n=t[s];/^on[A-Z]/.test(s)?a&&n?r[s]=(...e)=>{let t=n(...e);return a(...e),t}:a&&(r[s]=a):"style"===s?r[s]={...a,...n}:"className"===s&&(r[s]=[a,n].filter(Boolean).join(" "))}return{...e,...r}}(s,r.props);return r.type!==n.Fragment&&(d.ref=t?function(...e){return t=>{let r=!1,s=e.map(e=>{let s=i(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():i(e[t],null)}}}}(t,o):o),n.cloneElement(r,d)}return n.Children.count(r)>1?n.Children.only(null):null})).displayName="Slot.SlotClone",t=s,(r=n.forwardRef((e,r)=>{let{children:s,...i}=e;d(s)&&"function"==typeof o&&(s=o(s._payload));let l=n.Children.toArray(s),c=l.find(f);if(c){let e=c.props.children,s=l.map(t=>t!==c?t:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...i,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,s):null})}return(0,a.jsx)(t,{...i,ref:r,children:s})})).displayName="Slot.Slot",r),u=Symbol("radix.slottable");function f(e){return n.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===u}var m=e.i(75157);let p={default:"bg-accent text-white hover:bg-[#108a00] hover:text-white",secondary:"border border-accent bg-white text-accent hover:bg-[#e9f7e9]",outline:"border border-card-border bg-card text-foreground hover:border-accent hover:text-accent",ghost:"text-foreground hover:bg-[#e9f7e9]",destructive:"bg-red-500 text-white hover:bg-red-600",link:"bg-transparent text-accent underline-offset-4 hover:underline"},x={sm:"h-9 px-3 text-xs",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",icon:"h-10 w-10"},h=(0,n.forwardRef)(({asChild:e,className:t,variant:r="default",size:s="md",loading:n,children:i,disabled:l,...o},d)=>{let u=e?c:"button",f=(0,m.cn)("inline-flex items-center justify-center gap-2 rounded-[var(--radius-md)] font-medium transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent disabled:pointer-events-none disabled:opacity-60",p[r],x[s],t);return e?(0,a.jsx)(u,{ref:d,className:f,...o,children:i}):(0,a.jsxs)(u,{ref:d,className:f,disabled:l||n,...o,children:[n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent","aria-hidden":"true"}),(0,a.jsx)("span",{className:"sr-only",children:"Loading"})]}):null,(0,a.jsx)("span",{children:i})]})});h.displayName="Button",e.s(["Button",0,h],19455)},15288,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(75157);let a=(0,r.forwardRef)(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,s.cn)("rounded-[var(--radius-lg)] border border-card-border bg-card p-6 shadow-sm shadow-foreground/5",e),...r}));a.displayName="Card",e.s(["Card",0,a])},93479,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(75157);let a=(0,r.forwardRef)(({className:e,...r},a)=>(0,t.jsx)("input",{ref:a,className:(0,s.cn)("flex h-11 w-full rounded-[var(--radius-md)] border border-card-border bg-card px-4 text-foreground shadow-sm transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent placeholder:text-muted/60 disabled:cursor-not-allowed disabled:opacity-60",e),...r}));a.displayName="Input",e.s(["Input",0,a])},95187,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={callServer:function(){return n.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let n=e.r(32120),i=e.r(92245),l=e.r(35326)},24687,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(75157);let a=(0,r.forwardRef)(({className:e,...r},a)=>(0,t.jsx)("textarea",{ref:a,className:(0,s.cn)("flex min-h-[120px] w-full rounded-[var(--radius-md)] border border-card-border bg-card px-4 py-3 text-foreground shadow-sm transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent placeholder:text-muted/60 disabled:cursor-not-allowed disabled:opacity-60",e),...r}));a.displayName="Textarea",e.s(["Textarea",0,a])},75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:l="",children:o,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...a,width:r,height:r,stroke:e,strokeWidth:i?24*Number(n)/Number(r):n,className:s("lucide",l),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,a)=>{let i=(0,t.forwardRef)(({className:i,...l},o)=>(0,t.createElement)(n,{ref:o,iconNode:a,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...l}));return i.displayName=r(e),i};e.s(["default",()=>i],75254)},14141,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(46696),a=e.i(24687),n=e.i(19455);let i=(0,e.i(75254).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var l=e.i(7670);function o({url:e,isCurrent:r}){let{host:s,label:a,initials:n}=function(e){try{let t=new URL(e),r=t.hostname.replace(/^www\./,""),s=`${t.pathname}${t.search}${t.hash}`,a=s&&"/"!==s?decodeURI(s):void 0;return{host:r,label:a??r,initials:r.replace(/[^a-zA-Z0-9]/g,"").slice(0,2).toUpperCase()||r.slice(0,2).toUpperCase()}}catch{return{host:e.replace(/^https?:\/\//,""),label:e,initials:e.slice(0,2).toUpperCase()}}}(e);return(0,t.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:(0,l.default)("group block w-full overflow-hidden rounded-[var(--radius-md)] border text-left shadow-sm transition hover:-translate-y-[1px] hover:shadow-md",r?"border-accent-foreground/20 bg-accent/90 text-accent-foreground":"border-card-border/70 bg-card text-foreground"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3",children:[(0,t.jsx)("div",{className:(0,l.default)("flex h-10 w-10 shrink-0 items-center justify-center rounded-md text-sm font-semibold",r?"bg-accent-foreground/15 text-accent-foreground":"bg-foreground/10 text-foreground"),children:n}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:s}),(0,t.jsx)("p",{className:(0,l.default)("truncate text-xs",r?"text-accent-foreground/80":"text-muted-foreground"),children:a})]}),(0,t.jsx)(i,{className:(0,l.default)("h-4 w-4 shrink-0 transition group-hover:translate-x-[1px] group-hover:-translate-y-[1px]",r?"text-accent-foreground/80":"text-muted-foreground")})]})})}function d({contractId:e,currentUserId:i,participants:l,initialMessages:d}){let[c,u]=(0,r.useState)(d),[f,m]=(0,r.useState)(""),[p,x]=(0,r.useState)(!1),h=(0,r.useRef)(null),g=(0,r.useCallback)(async()=>{try{let t=await fetch(`/api/contracts/${e}/messages`);if(t.ok){let e=await t.json();e.messages&&u(e.messages)}}catch{}},[e]);(0,r.useEffect)(()=>{let e=setInterval(g,5e3);return()=>clearInterval(e)},[g]),(0,r.useEffect)(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[c]);let b=async()=>{if(f.trim()&&!p){x(!0);try{let t=await fetch(`/api/contracts/${e}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:f.trim()})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to send message")}m(""),await g()}catch(t){let e=t instanceof Error?t.message:"Failed to send message";s.toast.error(e)}finally{x(!1)}}};return(0,t.jsxs)("div",{className:"flex h-full flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-3 overflow-auto rounded-[var(--radius-md)] border border-card-border/70 bg-card/60 p-4",children:[c.map(e=>{let s=e.sender_id===i,a=l.find(t=>t.id===e.sender_id),n=e.content.split(/(https?:\/\/[^\s]+)/g),d=Array.from(new Set(n.filter(e=>e.startsWith("http://")||e.startsWith("https://"))));return(0,t.jsxs)("div",{className:`flex flex-col ${s?"items-end":"items-start"}`,children:[(0,t.jsx)("span",{className:"text-xs text-muted",children:a?.name??"Member"}),(0,t.jsx)("div",{className:`mt-1 max-w-[70%] rounded-[var(--radius-md)] px-3 py-2 text-sm ${s?"bg-accent text-accent-foreground":"bg-foreground/10 text-foreground"}`,children:(0,t.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed",children:n.map((s,a)=>s?s.startsWith("http://")||s.startsWith("https://")?(0,t.jsxs)(r.Fragment,{children:[(0,t.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"break-words font-medium underline decoration-current underline-offset-2 transition hover:opacity-80",children:s})," "]},`${e.id}-segment-${a}`):(0,t.jsx)("span",{children:s},`${e.id}-segment-${a}`):null)})}),d.length>0?(0,t.jsx)("div",{className:"mt-2 flex w-full max-w-[70%] flex-col gap-2",children:d.map(r=>(0,t.jsx)(o,{url:r,isCurrent:s},`${e.id}-${r}`))}):null,(0,t.jsx)("span",{className:"mt-1 text-[11px] text-muted",children:new Date(e.created_at).toLocaleString()})]},e.id)}),(0,t.jsx)("div",{ref:h})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Textarea,{value:f,onChange:e=>m(e.target.value),rows:3,placeholder:"Share updates, questions, or files (paste link)."}),(0,t.jsx)(n.Button,{onClick:b,loading:p,children:"Send"})]})]})}e.s(["ContractChat",()=>d],14141)},36435,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(74080),a=e.i(46696),n=e.i(95187),i=(0,n.createServerReference)("6056b793c2905a4401aa79482b322c3b7bc28acfc2",n.callServer,void 0,n.findSourceMapURL,"createMilestoneAction"),l=(0,n.createServerReference)("602eaae21159f520e50bf97595e24303dbcde59902",n.callServer,void 0,n.findSourceMapURL,"submitMilestoneAction"),o=(0,n.createServerReference)("608bb6de273b928b66ba5f7036ef8587e7ad85eebf",n.callServer,void 0,n.findSourceMapURL,"updateMilestoneStatusAction"),d=e.i(15288),c=e.i(87486),u=e.i(93479),f=e.i(24687),m=e.i(19455);let p={status:"idle"};function x({contractId:e,milestones:r,role:s}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:"Milestones"}),"employer"===s?(0,t.jsx)(h,{contractId:e}):null]}),(0,t.jsx)("div",{className:"grid gap-3",children:0===r.length?(0,t.jsx)(d.Card,{className:"border-dashed p-4 text-sm text-muted",children:"No milestones yet."}):r.map(r=>(0,t.jsxs)(d.Card,{className:"space-y-3 border border-card-border/70 bg-card/80 p-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-semibold text-foreground",children:r.title}),(0,t.jsxs)("p",{className:"text-sm text-muted",children:["à§³",Number(r.amount??0).toLocaleString()]}),r.due_date?(0,t.jsxs)("p",{className:"text-xs text-muted",children:["Due ",new Date(r.due_date).toLocaleDateString()]}):null]}),(0,t.jsx)(c.Badge,{variant:"muted",children:r.status})]}),r.deliverable_url?(0,t.jsx)("a",{href:r.deliverable_url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline",children:"View deliverable"}):null,r.notes?(0,t.jsxs)("p",{className:"text-sm text-muted",children:["Notes: ",r.notes]}):null,"freelancer"===s&&"pending"===r.status?(0,t.jsx)(g,{contractId:e,milestoneId:r.id}):null,"employer"===s&&"in_review"===r.status?(0,t.jsx)(b,{contractId:e,milestoneId:r.id}):null]},r.id))})]})}function h({contractId:e}){let[n,l]=(0,s.useFormState)(i,p),[o,d]=(0,r.useTransition)();return(0,r.useEffect)(()=>{"error"===n.status&&n.message?a.toast.error(n.message):"success"===n.status&&n.message&&a.toast.success(n.message)},[n]),(0,t.jsxs)("form",{className:"flex flex-wrap items-center gap-2",action:e=>{d(()=>l(e))},children:[(0,t.jsx)("input",{type:"hidden",name:"contractId",value:e}),(0,t.jsx)(u.Input,{name:"title",placeholder:"Milestone title",required:!0,className:"w-40"}),(0,t.jsx)(u.Input,{name:"amount",type:"number",min:0,step:"10",placeholder:"Amount",required:!0,className:"w-32"}),(0,t.jsx)(u.Input,{name:"dueDate",type:"date",className:"w-36"}),(0,t.jsx)(m.Button,{type:"submit",size:"sm",loading:o,children:"Add"})]})}function g({contractId:e,milestoneId:n}){let[i,o]=(0,s.useFormState)(l,p),[d,c]=(0,r.useTransition)();return(0,r.useEffect)(()=>{"error"===i.status&&i.message?a.toast.error(i.message):"success"===i.status&&i.message&&a.toast.success(i.message)},[i]),(0,t.jsxs)("form",{className:"space-y-2",action:e=>{c(()=>o(e))},children:[(0,t.jsx)("input",{type:"hidden",name:"contractId",value:e}),(0,t.jsx)("input",{type:"hidden",name:"milestoneId",value:n}),(0,t.jsx)(u.Input,{name:"deliverableUrl",placeholder:"Deliverable URL"}),(0,t.jsx)(f.Textarea,{name:"notes",rows:2,placeholder:"Notes for the employer"}),(0,t.jsx)(m.Button,{type:"submit",size:"sm",loading:d,children:"Submit for review"})]})}function b({contractId:e,milestoneId:n}){let[i,l]=(0,s.useFormState)(o,p),[d,c]=(0,r.useTransition)();return(0,r.useEffect)(()=>{"error"===i.status&&i.message?a.toast.error(i.message):"success"===i.status&&i.message&&a.toast.success(i.message)},[i]),(0,t.jsxs)("form",{className:"flex items-center gap-2",action:e=>{c(()=>l(e))},children:[(0,t.jsx)("input",{type:"hidden",name:"contractId",value:e}),(0,t.jsx)("input",{type:"hidden",name:"milestoneId",value:n}),(0,t.jsx)(m.Button,{type:"submit",size:"sm",name:"status",value:"approved",variant:"ghost",loading:d,children:"Approve"}),(0,t.jsx)(m.Button,{type:"submit",size:"sm",name:"status",value:"rejected",variant:"ghost",loading:d,children:"Request changes"})]})}e.s(["MilestonesSection",()=>x],36435)}]);